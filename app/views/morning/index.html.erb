<div class="morning">
  <h1>The Morning Show</h1>
  <div class="meta">
    Showing <%= @plays.size %> plays â€¢ Last updated <%= Time.current.strftime('%Y-%m-%d %H:%M') %>
  </div>
  <div class="actions">
    <%= button_to "Refresh Today", refresh_morning_index_path, method: :post, class: "btn" %>
    <%= button_to "Backfill Last 30 Days", backfill_morning_index_path, method: :post, class: "btn btn-danger" %>
  </div>
  <% if notice %>
    <p class="notice"><%= notice %></p>
  <% end %>
  <% if alert %>
    <p class="alert"><%= alert %></p>
  <% end %>
  <!-- ðŸŽµ Top 40 -->
  <%= turbo_frame_tag "top40" do %>
    <%= render partial: "top40", locals: { top_songs: @top_songs, period: @period } %>
  <% end %>
  <!-- ðŸŽµ Recent plays -->
  <h2>Recent Plays</h2>
  <div class="scroll-box">
    <% if @plays.present? %>
      <table class="recent-plays">
        <thead>
          <tr>
            <th>Time (PT)</th>
            <th>Artist</th>
            <th>Song</th>
            <th>Album</th>
          </tr>
        </thead>
        <tbody>
          <% @plays.each do |p| %>
            <tr>
              <td><%= p.played_at&.in_time_zone('Pacific Time (US & Canada)')&.strftime('%Y-%m-%d %H:%M') %></td>
              <td><%= p.artist %></td>
              <td><%= p.song %></td>
              <td><%= p.album %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <% else %>
      <p>No recent plays found yet. Try refreshing or backfilling.</p>
    <% end %>
  </div>
</div>
